<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tabla de Gustos</title>
<style>
    table {
        border-collapse: collapse;
        width: 100%;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
    }
    .editarBtn {
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 4px;
    }
    .enEdicion {
        background-color: #FFA500; 
    }
    .guardarBtn, .anularBtn {
        display: none;
    }
    .confirmacion {
        display: none;
    }
</style>
</head>
<body>

<h2>Formulario de Afiliación</h2>

<form id="formularioAfiliacion">
    <div>
        <label for="nombreCompleto">Nombre Completo:</label>
        <input type="text" id="nombreCompleto" name="nombreCompleto" required>
    </div>
    <div>
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
    </div>
    <div>
        <label for="telefono">Teléfono:</label>
        <input type="tel" id="telefono" name="telefono" required>
    </div>
</form>

<h2>Tabla de Gustos</h2>

<input type="text" id="gusto" placeholder="Ingrese un gusto">
<button onclick="agregarGusto()">Agregar Gusto</button>

<table id="tablaGustos">
    <tr>
        <th>Gusto</th>
        <th>Porcentaje</th>
        <th>Editar</th>
    </tr>
</table>

<div class="confirmacion">
    <p>Pulse: Aceptar para guardar los cambios o cancelar para anularlos</p>
</div>

<button class="guardarBtn" onclick="guardarCambios()">Guardar Cambios</button>
<button class="anularBtn" onclick="anularCambios()">Anular Cambios</button>

<script>
var cambiosPendientes = [];

function agregarGusto() {
    var gusto = document.getElementById("gusto").value;
    if (gusto === "") {
        alert("Por favor, ingrese un gusto.");
        return;
    }

    var tabla = document.getElementById("tablaGustos");
    var fila = tabla.insertRow();
    var celdaGusto = fila.insertCell(0);
    var celdaPorcentaje = fila.insertCell(1);
    var celdaEditar = fila.insertCell(2);

    celdaGusto.innerHTML = gusto;

    var inputPorcentaje = document.createElement("input");
    inputPorcentaje.type = "number";
    inputPorcentaje.min = "0";
    inputPorcentaje.max = "100";
    inputPorcentaje.placeholder = "0-100";
    inputPorcentaje.style.width = "60px"; 
    celdaPorcentaje.appendChild(inputPorcentaje);

    var editarBtn = document.createElement("button");
    editarBtn.innerHTML = "Editar";
    editarBtn.className = "editarBtn";
    editarBtn.onclick = function() {
        editarFila(fila);
    };
    celdaEditar.appendChild(editarBtn);


    cambiosPendientes.push({fila: fila, gusto: gusto, inputPorcentaje: inputPorcentaje});
}

function editarFila(fila) {
    var celdas = fila.getElementsByTagName("td");
    var inputGusto = document.createElement("input");
    inputGusto.type = "text";
    inputGusto.value = celdas[0].innerText;
    celdas[0].innerHTML = "";
    celdas[0].appendChild(inputGusto);

    var inputPorcentaje = document.createElement("input");
    inputPorcentaje.type = "number";
    inputPorcentaje.min = "0";
    inputPorcentaje.max = "100";
    inputPorcentaje.style.width = "60px"; 
    inputPorcentaje.value = celdas[1].innerText.replace("%", "");
    celdas[1].innerHTML = "";
    celdas[1].appendChild(inputPorcentaje);

    var editarBtn = celdas[2].querySelector("button");
    editarBtn.innerHTML = "En edición";
    editarBtn.classList.add("enEdicion"); 
    editarBtn.disabled = true; 

    var guardarBtn = document.querySelector(".guardarBtn");
    var anularBtn = document.querySelector(".anularBtn");
    guardarBtn.style.display = "inline-block";
    anularBtn.style.display = "inline-block";

    
    document.querySelector(".confirmacion").style.display = "block";
}

function guardarCambios() {
   
    cambiosPendientes.forEach(function(cambio) {
        cambio.fila.cells[0].innerHTML = cambio.fila.cells[0].querySelector("input").value;
        var porcentaje = cambio.fila.cells[1].querySelector("input").value + "%";
        cambio.fila.cells[1].innerHTML = porcentaje;
    });
    cambiosPendientes.forEach(function(cambio) {
        var editarBtn = cambio.fila.cells[2].querySelector(".editarBtn");
        editarBtn.innerHTML = "Editar";
        editarBtn.classList.remove("enEdicion"); 
        editarBtn.disabled = false;
    });
    cambiosPendientes = [];
    ocultarBotones();
   
    document.querySelector(".confirmacion").style.display = "none";
}

function anularCambios() {
   
    cambiosPendientes.forEach(function(cambio) {
        var inputGusto = cambio.fila.cells[0].querySelector("input");
        var inputPorcentaje = cambio.fila.cells[1].querySelector("input");
        cambio.fila.cells[0].innerHTML = inputGusto ? inputGusto.value : cambio.gusto;
        cambio.fila.cells[1].innerHTML = inputPorcentaje ? inputPorcentaje.value + "%" : cambio.inputPorcentaje.value;
    });
    cambiosPendientes.forEach(function(cambio) {
        var editarBtn = cambio.fila.cells[2].querySelector(".editarBtn");
        editarBtn.innerHTML = "Editar";
        editarBtn.classList.remove("enEdicion"); 
        editarBtn.disabled = false;
    });
    cambiosPendientes = [];
    ocultarBotones();
 
    document.querySelector(".confirmacion").style.display = "none";
}

function ocultarBotones() {
    var guardarBtn = document.querySelector(".guardarBtn");
    var anularBtn = document.querySelector(".anularBtn");
    guardarBtn.style.display = "none";
    anularBtn.style.display = "none";
}
</script>

</body>
</html>
